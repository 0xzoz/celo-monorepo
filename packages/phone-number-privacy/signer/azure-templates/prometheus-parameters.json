{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
      "location": {
          "value": "centralus"
      },
      "containerGroupName": {
          "value": "odis-prometheus"
      },
      "containerName1": {
          "value": "prometheus-server"
      },
      "containerName2": {
          "value": "prometheus-sidecar"
      },
      "imageType1": {
          "value": "Public"
      },
      "imageType2": {
          "value": "Public"
      },
      "imageName1": {
          "value": "prom/prometheus:v2.17.0"
      },
      "imageName2": {
          "value": "gcr.io/stackdriver-prometheus/stackdriver-prometheus-sidecar:0.7.3"
      },
      "osType": {
          "value": "Linux"
      },
      "numberCpuCores": {
          "value": "2"
      },
      "memory": {
          "value": "2"
      },
      "restartPolicy": {
          "value": "Always"
      },
      "environmentVariables2": {
        "value": [
          {
            "name": "GOOGLE_APPLICATION_CREDENTIALS",
            "value": "/var/secrets/google/prometheus-service-account-key.json"
          }
        ]
      },
      "ipAddressType": {
          "value": "Public"
      },
      "ports1": {
          "value": [
              {
                  "port": "9090",
                  "protocol": "TCP"
              }
          ]
      },
      "ports2": {
          "value": [
              {
                  "port": "9091",
                  "protocol": "TCP"
              }
          ]
      },
      "command1": {
          "value": [
            "/bin/prometheus",
            "--config.file=/etc/prometheus/prometheus.yaml",
            "--storage.tsdb.path=/prometheus/"
          ]
      },
      "command2": {
          "value": [
            "/bin/stackdriver-prometheus-sidecar",
            "--stackdriver.project-id=celo-phone-number-privacy-stg",
            "--prometheus.wal-directory=/prometheus/wal",
            "--stackdriver.kubernetes.location=us-central1",
            "--stackdriver.kubernetes.cluster-name=odis-staging",
            "--log.level=debug"
          ]
      },
      "volumeMounts1": {
          "value": [
            {
              "name": "prometheus-storage-volume",
              "mountPath": "/prometheus"
            },
            {
              "name": "prometheus-config-volume",
              "mountPath": "/etc/prometheus/"
            }
          ]
      },
      "volumeMounts2": {
          "value": [
            {
              "name": "prometheus-storage-volume",
              "mountPath": "/prometheus"
            },
            {
              "name": "prometheus-service-account-key",
              "mountPath": "/var/secrets/google"
            }
          ]
      },
      "volumes": {
          "value": [
            {
              "name": "prometheus-storage-volume",
              "emptyDir": {}
            },
            {
              "name": "prometheus-service-account-key",
              "secret": {
                "prometheus-service-account-key.json": "ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAiY2Vsby1waG9uZS1udW1iZXItcHJpdmFjeS1zdGciLAogICJwcml2YXRlX2tleV9pZCI6ICJhYWMzNDdkMjExOTIxYTAyNWRiYWNiOThkZjVjYjc4OWNmNGIxYmJjIiwKICAicHJpdmF0ZV9rZXkiOiAiLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdkFJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLWXdnZ1NpQWdFQUFvSUJBUUMrVGNUVVdPYmFsOTIxXG5LTDdFUDltSDlDbEVMM1d3VnNIVWNGUUlYRG5WRXhKTSsvcjlXdWZxdFRiTEt1anVoSHQ4WFYvb2NTTmhvTGFQXG5tbFoyeGFiVmFnVkZXbjJhRkRSbUlLaDE3N2xXejNndE45Z2VzNnNoOXhFWUxwdEQ3SFk3ZzhvRE1qa0t2WWVrXG52M1YxNDBUNXBrT1VDWS9LM296aVN4RlVEUS9vNnNyOEhMbTlnUTgyaFo5RHZITFpGeEh3dWtJbGY0dzFUL1dMXG5CWmpQZHBHMW9NR1c2aFFFb2ttK3VOaFRtM3VIOTd3QmovTmpTMHRBM050SHpPWUdHM2RubVpSYWM1aDNlM21iXG42Q3pTTnlSazR5NzR5NWNBSmQ5UEtsa0crQmRkRDZyZk03akhBM3FxUEpvTU9KZG0vTS9MRDhBaWZ6WnlSY2wvXG44cU95elp6ZEFnTUJBQUVDZ2dFQVUrMExOWlRoZHB6TUg1VlJFRTZTV2tWaEg1dUluUlNkMWRrV0RqdlNHM2lXXG5OUkpabmZ0RjFUcEc2SEhMbVVrZkJubE5qejY2R2xlY3U1Y1dzN20yT2w5UDVNYWtKdHZyUWZEOEtrcm5JM1JLXG43VEk0STA0Y1ZsWFdHYUtRUWZQYUxxUVA1cm55OHh3ajRwRzNOUjdlTC9WVnowY3FQWTlKZFpFaW1yMUorMjh4XG4zSDhiSWF1OHFJYlZWYmZHSm9FZnpYRFNwZVpJdXI0SGJCWEpIUm5PK1J4TDNwQnBrWFlURHQrSGxibm53NmJXXG40MHVYK0Nxekc0WnBmc0hkd1NwT1N6eVYzNG9aSE9mRzdpb0ZkaElCK1FRQjhhcmpTUlI4SUUxdkNiOEJvamplXG43WThsaEpHZDU1bjQ2U0p0bXN1S3RmMTBJRzB5SDRhRGgrd1F1cEU4eHdLQmdRRG53MVZYbENkdi90TUo2Q3o5XG53Mm9ndTlKcEJQbmtXSjVtR1FRZEFxLzBoSGdjZjQ1RnZRV0VaM2VZRzNpN3BiK2tlVWJxKzFBK1Y3QkVJdk9yXG43cm9PUXJaUkcrRWMvYTZ2MTh4YWlNTmNXcUdPOWJCNXUwNW03QVBPR0JWaFZnYU5DRVZhK2syUGpsb1AyNGRpXG40Zzc5NDc2Z3pKVm5wbEtPcE9wWU9jUmhmd0tCZ1FEU05JRmxWWjJ0MUhOdFhiOUhpYUk5WTJhNnA5NGZOd0JCXG5ybHVvbm9LVWQ5NkJKamdCNzkvZW9pMjJQY3pVS1g5eVRrNGRWN25VeXdLZndIWGNSengvZmFoR3JQQ005YzczXG44S1RaSXlUNkg3TkFpcDNCcHkyZGU5eXhBQ0Zuai84OEhuMDJmMk9aS0oweUJNUDU2WnJjbnVicjYyNS80bXVIXG50MGlCUkU3M293S0JnQmtVZGtQSDhJeWFFdFJibjZMR1p0R3NBWlVEeU5jQkVBTVVhZkdKdk9qRS9RcDRjemp3XG52NHdZZGtTcmxHRWFDcWNOeUxMZEIwMzN4MGRZVU80bUkxUXZ1L01EQlZWUnpubVE3TGhQWEhTK0NnV2lhTHFEXG5ublJjemZ5YmRwVFY3bGVNc1pTcXlZSGpjYk9ObWhVRlNZSUlCelQzYnFPTXlCcFBsbHg5dzlhWkFvR0FOTE9EXG5TWk80ajY5M0xSRlc5cW1VS28zMFlKSGJ4N216YjhRMktNVnMrYW8vOStOTUlYZ3hpWkRob3hKRmUxL1lHeUYwXG54amlMVjhWNkovRkoyMnRreUpZSmpZYW9YTDc0SUFPT1lQNUZ0QXdrbGVicS9IVmNvMkk5aDRiLzJRWXFPTGx3XG5MU3l0SE9ZbzJ6U0VxZkNlcWZlUTc4ODhDZ1lMYmFCUEpsR285cjhDZ1lCaXVtMkJNV3Y5dUdweTJzc2lzUm9FXG4vSkloVTh3cHdXL1lNUHo4TWV4Y0lEYzJlbUthbHJrNUdJbUduTFg4b2IxTmVOeUI2MXovVi9SWGdBZThPRHBtXG43dXoxaTl3Zm5DTGUwNUoxY1NqMjY2a3dlWVlVZHI3cVJ5RTFHSlcyNG56WUR0U0h1VnFmcUF5TGd4TnA5WE1XXG5DN1pHRHk2MjFodEdBNTJndWRhQmxnPT1cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbiIsCiAgImNsaWVudF9lbWFpbCI6ICJvZGlzLXN0YWdpbmctcHJvbWV0aGV1c0BjZWxvLXBob25lLW51bWJlci1wcml2YWN5LXN0Zy5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgImNsaWVudF9pZCI6ICIxMDUwNzA4MTM5MDAwMTUyMDE4MjkiLAogICJhdXRoX3VyaSI6ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aCIsCiAgInRva2VuX3VyaSI6ICJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsCiAgImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjEvY2VydHMiLAogICJjbGllbnRfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9yb2JvdC92MS9tZXRhZGF0YS94NTA5L29kaXMtc3RhZ2luZy1wcm9tZXRoZXVzJTQwY2Vsby1waG9uZS1udW1iZXItcHJpdmFjeS1zdGcuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iCn0K"
              }
            },
            {
              "name": "prometheus-config-volume",
              "secret": {
                "prometheus.yaml": "Z2xvYmFsOgogIHNjcmFwZV9pbnRlcnZhbDogNjBzCnNjcmFwZV9jb25maWdzOgogIC0gam9iX25hbWU6IHNjcmFwZS1vZGlzCiAgICBzY2hlbWU6IGh0dHBzCiAgICBtZXRyaWNzX3BhdGg6IC9tZXRyaWNzCiAgICBzdGF0aWNfY29uZmlnczoKICAgICAgLSB0YXJnZXRzOgogICAgICAgICAgLSAyMC4zNy4xMzMuMjEyOjQ0MwogICAgICAgICAgLSAyMC4zNy4xMzIuNzc6NDQzCiAgICAgICAgICAtIDUyLjE1NC4yMDUuMTk0OjQ0MwogICAgICAgIGxhYmVsczoKICAgICAgICAgIF9nZW5lcmljX2xvY2F0aW9uOiBjZW50cmFsdXMKICAgICAgICAgIF9nZW5lcmljX25hbWVzcGFjZTogb2Rpcy1zaWduZXIK"
              }
            }
          ]
      }
  }
}